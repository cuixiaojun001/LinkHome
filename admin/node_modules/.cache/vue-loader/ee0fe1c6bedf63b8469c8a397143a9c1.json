{"remainingRequest":"/Users/ke/workspace/platform/house_admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/ke/workspace/platform/house_admin/src/views/user/index.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/ke/workspace/platform/house_admin/src/views/user/index.vue","mtime":1716445932139},{"path":"/Users/ke/workspace/platform/house_admin/node_modules/cache-loader/dist/cjs.js","mtime":1716446970693},{"path":"/Users/ke/workspace/platform/house_admin/node_modules/babel-loader/lib/index.js","mtime":1716446972394},{"path":"/Users/ke/workspace/platform/house_admin/node_modules/cache-loader/dist/cjs.js","mtime":1716446970693},{"path":"/Users/ke/workspace/platform/house_admin/node_modules/vue-loader/lib/index.js","mtime":1716446972582}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB1dGlsc0FwaSBmcm9tICJAL2FwaS91dGlscy5qcyI7CgpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGxpc3Q6IG51bGwsIC8vIOaVsOaNruWIl+ihqAogICAgICB0b3RhbDogMCwgLy8g5pWw5o2u5bqT5Lit55qE5oC76K6w5b2V5pWwCiAgICAgIHBhZ2U6IDEsIC8vIOm7mOiupOmhteeggQogICAgICBsaW1pdDogNSwgLy8g5q+P6aG16K6w5b2V5pWwCiAgICAgIHNlYXJjaE9iajogewogICAgICAgIG1vYmlsZTogbnVsbCwKICAgICAgICBzdGF0ZTogbnVsbCwKICAgICAgfSwgLy8g5p+l6K+i5p2h5Lu2CiAgICB9OwogIH0sCgogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmZldGNoRGF0YSgpOwogIH0sCgogIG1ldGhvZHM6IHsKICAgIC8vIOiOt+WPluWIl+ihqOaVsOaNrgogICAgZmV0Y2hEYXRhKCkgewogICAgICAvLyDlsIHoo4XliIbpobXlj4LmlbAKICAgICAgdmFyIHBhcmFtID0ge307CiAgICAgIHBhcmFtLm9mZnNldCA9ICh0aGlzLnBhZ2UgLSAxKSAqIHRoaXMubGltaXQ7CiAgICAgIHBhcmFtLmxpbWl0ID0gdGhpcy5saW1pdDsKICAgICAgcGFyYW0ucXVlcnlfcGFyYW1zID0ge307CiAgICAgIGlmICh0aGlzLnNlYXJjaE9iai5tb2JpbGUgIT09IG51bGwgJiYgdGhpcy5zZWFyY2hPYmoubW9iaWxlICE9PSAiIikgewogICAgICAgIHBhcmFtLnF1ZXJ5X3BhcmFtcy5tb2JpbGUgPSB0aGlzLnNlYXJjaE9iai5tb2JpbGU7CiAgICAgIH0KICAgICAgaWYgKHRoaXMuc2VhcmNoT2JqLnN0YXRlICE9PSBudWxsICYmIHRoaXMuc2VhcmNoT2JqLnN0YXRlICE9PSAiIikgewogICAgICAgIHBhcmFtLnF1ZXJ5X3BhcmFtcy5zdGF0ZSA9IFtdOwogICAgICAgIHBhcmFtLnF1ZXJ5X3BhcmFtcy5zdGF0ZS5wdXNoKHRoaXMuc2VhcmNoT2JqLnN0YXRlKTsKICAgICAgfQogICAgICB1dGlsc0FwaS5nZXRVc2VyTGlzdChwYXJhbSkudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICB0aGlzLmxpc3QgPSByZXNwb25zZS5kYXRhLmRhdGFfbGlzdDsKICAgICAgICB0aGlzLnRvdGFsID0gcmVzcG9uc2UuZGF0YS50b3RhbDsKICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubGlzdC5sZW5ndGg7ICsraSkgewogICAgICAgICAgLy8g54m55q6K5aSE55CGOuWwhuazqOWGjOaXtumXtOeahOaXtumXtOaIs+i9rOS4uuaXtumXtOWtl+espuS4sgogICAgICAgICAgdmFyIHRpbWUgPSB0aGlzLmxpc3RbaV0uY3JlYXRlX3RzOwogICAgICAgICAgdmFyIHRpbWVTdHIgPSBuZXcgRGF0ZShwYXJzZUludCh0aW1lKSAqIDEwMDApCiAgICAgICAgICAgIC50b0xvY2FsZVN0cmluZygpCgogICAgICAgICAgICAucmVwbGFjZSgvOlxkezEsMn0kLywgIiAiKTsKICAgICAgICAgIHRoaXMubGlzdFtpXS5jcmVhdGVfdHMgPSB0aW1lU3RyOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAoKICAgIC8vIOi3s+i9rOiHs+eUqOaIt+S/oeaBr+ivpuaDhemhtQogICAgdG9EZXRhaWwoaWQpIHsKICAgICAgdGhpcy4kcm91dGVyLnB1c2goewogICAgICAgIHBhdGg6ICIvdXNlci9kZXRhaWwiLAogICAgICAgIHF1ZXJ5OiB7CiAgICAgICAgICB1c2VySWQ6IGlkLAogICAgICAgIH0sCiAgICAgIH0pOwogICAgfSwKCiAgICAvLyDlvZPkv67mlLnmr4/pobXmmL7npLrnmoTorrDlvZXmlbDml7bosIPnlKjmraTlh73mlbAKICAgIGNoYW5nZVBhZ2VTaXplKHNpemUpIHsKICAgICAgdGhpcy5saW1pdCA9IHNpemU7CiAgICAgIC8vIOmHjeaWsOiOt+WPluS4gOasoeaVsOaNrgogICAgICB0aGlzLmZldGNoRGF0YSgpOwogICAgfSwKICAgIC8vIOW9k+eCueWHu+mhteeggei/m+ihjOmhtemdouWIh+aNouaXtuiwg+eUqOatpOWHveaVsAogICAgY2hhbmdlQ3VycmVudFBhZ2UocGFnZSkgewogICAgICB0aGlzLnBhZ2UgPSBwYWdlOwogICAgICAvLyDph43mlrDojrflj5bkuIDmrKHmlbDmja4KICAgICAgdGhpcy5mZXRjaERhdGEoKTsKICAgIH0sCiAgICAvLyDmuIXnqbrmn6Xor6LmnaHku7YKICAgIHJlc2V0RGF0YSgpIHsKICAgICAgLy8g6L+Y5Y6f5p+l6K+i6KGo5Y2VCiAgICAgIHRoaXMuc2VhcmNoT2JqID0ge307CiAgICAgIC8vIOmHjeaWsOiOt+WPluS4gOasoeaVsOaNrgogICAgICB0aGlzLmZldGNoRGF0YSgpOwogICAgfSwKICB9LAp9Owo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AA0GA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/user","sourcesContent":["<template>\n  <div class=\"app-container\">\n    <!-- 查询表单 -->\n    <el-form :inline=\"true\" class=\"demo-form-inline\">\n      <el-form-item label=\"手机号\">\n        <el-input v-model=\"searchObj.mobile\" placeholder=\"手机号\" />\n      </el-form-item>\n\n      <el-form-item label=\"用户状态\">\n        <el-select v-model=\"searchObj.state\" placeholder=\"请选择\" clearable>\n          <el-option label=\"正常\" value=\"normal\" />\n          <el-option label=\"锁定\" value=\"deleted\" />\n        </el-select>\n      </el-form-item>\n      <el-button type=\"primary\" icon=\"el-icon-search\" @click=\"fetchData()\">\n        查询\n      </el-button>\n      <el-button type=\"default\" @click=\"resetData()\">清空</el-button>\n    </el-form>\n    <!-- 列表 -->\n    <el-table :data=\"list\" border stripe>\n      <el-table-column label=\"#\" width=\"60\">\n        <template slot-scope=\"scope\">\n          {{ (page - 1) * limit + scope.$index + 1 }}\n        </template>\n      </el-table-column>\n\n      <el-table-column\n        prop=\"username\"\n        label=\"用户姓名\"\n        align=\"center\"\n        sortable\n      />\n      <el-table-column prop=\"mobile\" label=\"手机号\" align=\"center\" sortable />\n      <el-table-column prop=\"gender\" label=\"性别\" align=\"center\">\n        <template slot-scope=\"scope\">\n          <el-tag type=\"info\" v-if=\"scope.row.gender === 'male'\">男</el-tag>\n          <el-tag type=\"info\" v-if=\"scope.row.gender === 'female'\">女</el-tag>\n        </template>\n      </el-table-column>\n      <el-table-column prop=\"role\" label=\"用户角色\" align=\"center\">\n        <template slot-scope=\"scope\">\n          <el-tag v-if=\"scope.row.role === 'admin'\">管理员</el-tag>\n          <el-tag v-if=\"scope.row.role === 'tenant'\">租客</el-tag>\n          <el-tag v-if=\"scope.row.role === 'landlord'\">房东</el-tag>\n          <el-tag v-if=\"scope.row.role === 'steward'\">管家</el-tag>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"用户状态\" width=\"90\" align=\"center\">\n        <template slot-scope=\"scope\">\n          <el-tag v-if=\"scope.row.state === 'normal'\" type=\"success\">\n            正常\n          </el-tag>\n          <el-tag v-else type=\"danger\"> 锁定 </el-tag>\n        </template>\n      </el-table-column>\n      <el-table-column\n        prop=\"create_ts\"\n        label=\"注册时间\"\n        align=\"center\"\n        sortable\n      />\n      <el-table-column label=\"操作\" align=\"center\" width=\"200\">\n        <template slot-scope=\"scope\">\n          <el-button\n            v-if=\"scope.row.state == 'normal'\"\n            type=\"warning\"\n            size=\"mini\"\n            @click=\"lock(scope.row.id, 0)\"\n          >\n            锁定\n          </el-button>\n          <el-button\n            v-else\n            type=\"danger\"\n            size=\"mini\"\n            @click=\"lock(scope.row.id, 1)\"\n          >\n            解锁\n          </el-button>\n          <el-button\n            type=\"primary\"\n            size=\"mini\"\n            @click=\"toDetail(scope.row.user_id)\"\n          >\n            查看详情\n          </el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n\n    <!-- 分页组件 -->\n    <el-pagination\n      @size-change=\"changePageSize\"\n      @current-change=\"changeCurrentPage\"\n      :current-page=\"page\"\n      :page-sizes=\"[5, 10, 15, 20]\"\n      :page-size=\"limit\"\n      layout=\"total, sizes, prev, pager, next, jumper\"\n      :total=\"total\"\n      style=\"padding: 30px 0\"\n    ></el-pagination>\n  </div>\n</template>\n\n<script>\nimport utilsApi from \"@/api/utils.js\";\n\nexport default {\n  data() {\n    return {\n      list: null, // 数据列表\n      total: 0, // 数据库中的总记录数\n      page: 1, // 默认页码\n      limit: 5, // 每页记录数\n      searchObj: {\n        mobile: null,\n        state: null,\n      }, // 查询条件\n    };\n  },\n\n  created() {\n    this.fetchData();\n  },\n\n  methods: {\n    // 获取列表数据\n    fetchData() {\n      // 封装分页参数\n      var param = {};\n      param.offset = (this.page - 1) * this.limit;\n      param.limit = this.limit;\n      param.query_params = {};\n      if (this.searchObj.mobile !== null && this.searchObj.mobile !== \"\") {\n        param.query_params.mobile = this.searchObj.mobile;\n      }\n      if (this.searchObj.state !== null && this.searchObj.state !== \"\") {\n        param.query_params.state = [];\n        param.query_params.state.push(this.searchObj.state);\n      }\n      utilsApi.getUserList(param).then((response) => {\n        this.list = response.data.data_list;\n        this.total = response.data.total;\n        for (var i = 0; i < this.list.length; ++i) {\n          // 特殊处理:将注册时间的时间戳转为时间字符串\n          var time = this.list[i].create_ts;\n          var timeStr = new Date(parseInt(time) * 1000)\n            .toLocaleString()\n\n            .replace(/:\\d{1,2}$/, \" \");\n          this.list[i].create_ts = timeStr;\n        }\n      });\n    },\n\n    // 跳转至用户信息详情页\n    toDetail(id) {\n      this.$router.push({\n        path: \"/user/detail\",\n        query: {\n          userId: id,\n        },\n      });\n    },\n\n    // 当修改每页显示的记录数时调用此函数\n    changePageSize(size) {\n      this.limit = size;\n      // 重新获取一次数据\n      this.fetchData();\n    },\n    // 当点击页码进行页面切换时调用此函数\n    changeCurrentPage(page) {\n      this.page = page;\n      // 重新获取一次数据\n      this.fetchData();\n    },\n    // 清空查询条件\n    resetData() {\n      // 还原查询表单\n      this.searchObj = {};\n      // 重新获取一次数据\n      this.fetchData();\n    },\n  },\n};\n</script>\n"]}]}